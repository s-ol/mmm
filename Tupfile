.gitignore

!download = |> ^ DOWNLOAD %O^ curl -L https://github.com/fengari-lua/fengari-web/releases/download/@(FENGARI_VERSION)/`basename %o` > %o |>
!moonc    = |> ^ MOON %b^ moonc           -o %o %f |> dist/%f.lua
!sassc    = |> ^ SCSS %b^ sassc -mauto       %f %o |> | %o.map

preload app app/tags lib

CLIENT += app/*.moon
CLIENT += app/tags/*.moon
CLIENT += lib/*.client.moon
CLIENT += lib/*.shared.moon

# download fengari dependencies
: |> !download |> dist/fengari-web.js
: |> !download |> dist/fengari-web.js.map

# compile client imports
: foreach $(CLIENT) |> !moonc |>

# render stylesheet
: scss/main.scss |> !sassc |> dist/main.css

# render static content
run moon tup.moon
